<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LSApp to Microsoft 365 - Technical Addendum</title>
    <style>
        :root {
            --gov-blue: #003366;
            --gov-gold: #FCBA19;
            --ms-blue: #0078D4;
            --ms-dark: #106EBE;
            --success-green: #107C10;
            --warning-orange: #FF8C00;
            --danger-red: #D13438;
            --light-bg: #F2F2F2;
            --text-primary: #313132;
            --code-bg: #1e1e1e;
            --code-text: #d4d4d4;
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'BC Sans', 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.6;
            color: var(--text-primary);
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #fff;
        }

        header {
            background: linear-gradient(135deg, var(--gov-blue) 0%, var(--ms-blue) 100%);
            color: white;
            padding: 30px 40px;
            margin: -20px -20px 30px -20px;
            border-bottom: 4px solid var(--gov-gold);
        }

        header h1 {
            margin: 0 0 10px 0;
            font-size: 2em;
            font-weight: 700;
        }

        header .subtitle {
            font-size: 1.1em;
            opacity: 0.9;
        }

        header .badge {
            display: inline-block;
            background: var(--gov-gold);
            color: var(--gov-blue);
            padding: 5px 15px;
            border-radius: 4px;
            font-weight: 600;
            margin-top: 15px;
        }

        .toc {
            background: var(--light-bg);
            padding: 25px 30px;
            border-radius: 8px;
            margin-bottom: 35px;
        }

        .toc h2 {
            margin-top: 0;
            color: var(--gov-blue);
        }

        .toc ol {
            columns: 2;
            column-gap: 40px;
        }

        .toc li {
            margin-bottom: 8px;
        }

        .toc a {
            color: var(--ms-blue);
            text-decoration: none;
        }

        .toc a:hover {
            text-decoration: underline;
        }

        h2 {
            color: var(--gov-blue);
            border-bottom: 2px solid var(--gov-gold);
            padding-bottom: 10px;
            margin-top: 45px;
        }

        h3 {
            color: var(--ms-blue);
            margin-top: 30px;
        }

        h4 {
            color: #444;
            margin-top: 20px;
        }

        .section {
            margin-bottom: 40px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 0.95em;
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        th {
            background: var(--gov-blue);
            color: white;
            font-weight: 600;
        }

        tr:nth-child(even) {
            background: #f8f9fa;
        }

        code {
            background: #e9ecef;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9em;
        }

        pre {
            background: var(--code-bg);
            color: var(--code-text);
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9em;
            line-height: 1.5;
        }

        pre code {
            background: none;
            padding: 0;
            color: inherit;
        }

        .keyword { color: #569cd6; }
        .string { color: #ce9178; }
        .comment { color: #6a9955; }
        .property { color: #9cdcfe; }
        .value { color: #b5cea8; }

        .warning-box {
            background: #fff4ce;
            border-left: 4px solid var(--warning-orange);
            padding: 20px;
            border-radius: 0 8px 8px 0;
            margin: 20px 0;
        }

        .danger-box {
            background: #fde7e9;
            border-left: 4px solid var(--danger-red);
            padding: 20px;
            border-radius: 0 8px 8px 0;
            margin: 20px 0;
        }

        .info-box {
            background: #deecf9;
            border-left: 4px solid var(--ms-blue);
            padding: 20px;
            border-radius: 0 8px 8px 0;
            margin: 20px 0;
        }

        .success-box {
            background: #dff6dd;
            border-left: 4px solid var(--success-green);
            padding: 20px;
            border-radius: 0 8px 8px 0;
            margin: 20px 0;
        }

        .schema-box {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        .schema-box h4 {
            margin-top: 0;
            color: var(--ms-blue);
            border-bottom: 1px solid #dee2e6;
            padding-bottom: 10px;
        }

        .column-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 10px;
        }

        .column-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 12px;
            background: white;
            border-radius: 4px;
            border: 1px solid #e9ecef;
        }

        .column-item .name {
            font-weight: 600;
            color: var(--gov-blue);
        }

        .column-item .type {
            color: #666;
            font-size: 0.9em;
        }

        .limitation-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .limitation-card {
            background: #fff4ce;
            border-radius: 8px;
            padding: 20px;
            border-left: 4px solid var(--warning-orange);
        }

        .limitation-card h4 {
            margin-top: 0;
            color: var(--warning-orange);
        }

        .limitation-card .limit {
            font-size: 1.5em;
            font-weight: 700;
            color: var(--danger-red);
        }

        .workaround {
            background: #e8f4e8;
            padding: 10px 15px;
            border-radius: 4px;
            margin-top: 10px;
            font-size: 0.9em;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin: 25px 0;
        }

        .comparison-card {
            background: var(--light-bg);
            border-radius: 8px;
            padding: 25px;
        }

        .comparison-card h4 {
            margin-top: 0;
            border-bottom: 2px solid var(--gov-gold);
            padding-bottom: 8px;
        }

        .comparison-card.sqlite {
            border-left: 4px solid var(--success-green);
        }

        .comparison-card.sharepoint {
            border-left: 4px solid var(--ms-blue);
        }

        .flow-diagram {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 25px;
            margin: 20px 0;
            font-family: monospace;
        }

        .flow-step {
            display: flex;
            align-items: center;
            margin: 10px 0;
        }

        .flow-step .step-box {
            background: var(--ms-blue);
            color: white;
            padding: 10px 20px;
            border-radius: 6px;
            min-width: 200px;
            text-align: center;
        }

        .flow-step .arrow {
            color: var(--ms-blue);
            font-size: 1.5em;
            margin: 0 15px;
        }

        ul {
            padding-left: 20px;
        }

        li {
            margin-bottom: 8px;
        }

        footer {
            margin-top: 50px;
            padding-top: 20px;
            border-top: 2px solid var(--gov-gold);
            text-align: center;
            color: #666;
            font-size: 0.9em;
        }

        @media (max-width: 768px) {
            .comparison-grid { grid-template-columns: 1fr; }
            .toc ol { columns: 1; }
            .column-list { grid-template-columns: 1fr; }
        }

        @media print {
            body { max-width: 100%; }
            header { margin: 0 0 30px 0; }
            pre { white-space: pre-wrap; }
        }
    </style>
</head>
<body>
    <header>
        <h1>LSApp to Microsoft 365</h1>
        <div class="subtitle">Technical Addendum - Implementation Details & Platform Limitations</div>
        <div class="badge">TECHNICAL DOCUMENT</div>
    </header>

    <nav class="toc">
        <h2>Table of Contents</h2>
        <ol>
            <li><a href="#sharepoint-lists">SharePoint List Schema Design</a></li>
            <li><a href="#limitations">Platform Limitations & Thresholds</a></li>
            <li><a href="#power-apps">Power Apps Architecture</a></li>
            <li><a href="#power-automate">Power Automate Workflows</a></li>
            <li><a href="#search">Search Comparison: FTS5 vs SharePoint</a></li>
            <li><a href="#data-migration">Data Migration Strategy</a></li>
            <li><a href="#security">Security & Permissions Model</a></li>
            <li><a href="#elm-sync">ELM Sync Implementation Challenges</a></li>
            <li><a href="#power-bi">Power BI Integration</a></li>
            <li><a href="#platform-churn">Platform Churn History</a></li>
            <li><a href="#hybrid">Hybrid Architecture Option</a></li>
            <li><a href="#licensing">Licensing Deep Dive</a></li>
        </ol>
    </nav>

    <section id="sharepoint-lists" class="section">
        <h2>1. SharePoint List Schema Design</h2>

        <p>To replicate lsapp5000's SQLite database in SharePoint, the following Lists would be required:</p>

        <div class="schema-box">
            <h4>Courses List (Primary)</h4>
            <p><strong>Purpose:</strong> Store course catalog (~300 items)</p>
            <div class="column-list">
                <div class="column-item"><span class="name">CourseID</span><span class="type">Single line text (PK)</span></div>
                <div class="column-item"><span class="name">CourseName</span><span class="type">Single line text</span></div>
                <div class="column-item"><span class="name">CourseShort</span><span class="type">Single line text</span></div>
                <div class="column-item"><span class="name">CourseDescription</span><span class="type">Multiple lines (Rich)</span></div>
                <div class="column-item"><span class="name">CourseAbstract</span><span class="type">Multiple lines</span></div>
                <div class="column-item"><span class="name">Status</span><span class="type">Choice (Active/Inactive/Deleted)</span></div>
                <div class="column-item"><span class="name">Topic</span><span class="type">Lookup → Topics</span></div>
                <div class="column-item"><span class="name">Audience</span><span class="type">Lookup → Audiences</span></div>
                <div class="column-item"><span class="name">DeliveryMethod</span><span class="type">Lookup → DeliveryMethods</span></div>
                <div class="column-item"><span class="name">Partner</span><span class="type">Lookup → Partners</span></div>
                <div class="column-item"><span class="name">Keywords</span><span class="type">Multiple lines</span></div>
                <div class="column-item"><span class="name">Prerequisites</span><span class="type">Multiple lines</span></div>
                <div class="column-item"><span class="name">MinEnrollment</span><span class="type">Number</span></div>
                <div class="column-item"><span class="name">MaxEnrollment</span><span class="type">Number</span></div>
                <div class="column-item"><span class="name">Featured</span><span class="type">Yes/No</span></div>
                <div class="column-item"><span class="name">HUBInclude</span><span class="type">Yes/No</span></div>
                <div class="column-item"><span class="name">ELMCourseID</span><span class="type">Single line text</span></div>
                <div class="column-item"><span class="name">Color</span><span class="type">Single line text</span></div>
                <div class="column-item"><span class="name">Modified</span><span class="type">Date/Time (auto)</span></div>
                <div class="column-item"><span class="name">ModifiedBy</span><span class="type">Person (auto)</span></div>
            </div>
            <p style="margin-top: 15px;"><strong>Note:</strong> lsapp5000 has 130+ columns. Many would need to be added as needed, but SharePoint Lists have a practical limit of ~50-100 columns before management becomes difficult.</p>
        </div>

        <div class="schema-box">
            <h4>Classes List</h4>
            <p><strong>Purpose:</strong> Store class instances (~1000+ items)</p>
            <div class="column-list">
                <div class="column-item"><span class="name">ClassID</span><span class="type">Single line text (PK)</span></div>
                <div class="column-item"><span class="name">Course</span><span class="type">Lookup → Courses</span></div>
                <div class="column-item"><span class="name">Venue</span><span class="type">Lookup → Venues</span></div>
                <div class="column-item"><span class="name">StartDate</span><span class="type">Date/Time</span></div>
                <div class="column-item"><span class="name">EndDate</span><span class="type">Date/Time</span></div>
                <div class="column-item"><span class="name">StartTime</span><span class="type">Single line text</span></div>
                <div class="column-item"><span class="name">EndTime</span><span class="type">Single line text</span></div>
                <div class="column-item"><span class="name">Status</span><span class="type">Choice</span></div>
                <div class="column-item"><span class="name">Enrolled</span><span class="type">Number</span></div>
                <div class="column-item"><span class="name">Waitlisted</span><span class="type">Number</span></div>
                <div class="column-item"><span class="name">Facilitators</span><span class="type">Multiple lines</span></div>
                <div class="column-item"><span class="name">WebinarLink</span><span class="type">Hyperlink</span></div>
            </div>
        </div>

        <div class="schema-box">
            <h4>CourseChanges List (Change Requests)</h4>
            <p><strong>Purpose:</strong> Track course modification requests</p>
            <div class="column-list">
                <div class="column-item"><span class="name">ChangeID</span><span class="type">Auto-number (PK)</span></div>
                <div class="column-item"><span class="name">Course</span><span class="type">Lookup → Courses</span></div>
                <div class="column-item"><span class="name">Category</span><span class="type">Choice</span></div>
                <div class="column-item"><span class="name">Description</span><span class="type">Multiple lines (Rich)</span></div>
                <div class="column-item"><span class="name">Scope</span><span class="type">Choice (Minor/Moderate/Major)</span></div>
                <div class="column-item"><span class="name">Urgent</span><span class="type">Yes/No</span></div>
                <div class="column-item"><span class="name">Progress</span><span class="type">Choice</span></div>
                <div class="column-item"><span class="name">ApprovalStatus</span><span class="type">Choice</span></div>
                <div class="column-item"><span class="name">AssignedTo</span><span class="type">Person</span></div>
                <div class="column-item"><span class="name">CreatedBy</span><span class="type">Person (auto)</span></div>
                <div class="column-item"><span class="name">Created</span><span class="type">Date/Time (auto)</span></div>
            </div>
        </div>

        <div class="schema-box">
            <h4>Additional Required Lists</h4>
            <ul>
                <li><strong>People:</strong> Supplement to Azure AD for roles/assignments</li>
                <li><strong>Venues:</strong> Training locations</li>
                <li><strong>Partners:</strong> Learning Hub partners</li>
                <li><strong>Topics:</strong> Lookup table (17 items)</li>
                <li><strong>Audiences:</strong> Lookup table (4 items)</li>
                <li><strong>DeliveryMethods:</strong> Lookup table (5 items)</li>
                <li><strong>ChangeTimeline:</strong> Field-level change history</li>
                <li><strong>ChangeComments:</strong> Discussion thread per change</li>
                <li><strong>ClassNotes:</strong> Notes on classes</li>
                <li><strong>CoursesPeople:</strong> Junction for instructor assignments</li>
            </ul>
            <p><strong>Total Lists Required:</strong> 12-15 SharePoint Lists</p>
        </div>
    </section>

    <section id="limitations" class="section">
        <h2>2. Platform Limitations & Thresholds</h2>

        <div class="danger-box">
            <strong>Critical:</strong> SharePoint and Power Platform have hard limits that differ significantly from SQLite's capabilities. These must be understood before committing to an MS365 approach.
        </div>

        <div class="limitation-grid">
            <div class="limitation-card">
                <h4>List View Threshold</h4>
                <div class="limit">5,000 items</div>
                <p>Views cannot display or filter more than 5,000 items without indexed columns.</p>
                <div class="workaround"><strong>Workaround:</strong> Index columns used in filters; use pagination; archive old data.</div>
            </div>
            <div class="limitation-card">
                <h4>List Item Limit</h4>
                <div class="limit">30 million</div>
                <p>Maximum items per list. Not a concern for LSApp's data volume.</p>
                <div class="workaround"><strong>Impact:</strong> None for this use case.</div>
            </div>
            <div class="limitation-card">
                <h4>Lookup Column Limit</h4>
                <div class="limit">12 per query</div>
                <p>Views can only include 12 lookup columns maximum.</p>
                <div class="workaround"><strong>Workaround:</strong> Denormalize data; use multiple views.</div>
            </div>
            <div class="limitation-card">
                <h4>Power Apps Row Limit</h4>
                <div class="limit">500-2,000 rows</div>
                <p>Non-delegable queries return max 500-2,000 rows (configurable).</p>
                <div class="workaround"><strong>Workaround:</strong> Use delegable functions only; server-side filtering.</div>
            </div>
            <div class="limitation-card">
                <h4>Power Automate Runs</h4>
                <div class="limit">Varies by license</div>
                <p>Standard: 6,000/month; Premium: 40,000/month per user.</p>
                <div class="workaround"><strong>Impact:</strong> ELM sync frequency limited; complex flows consume runs quickly.</div>
            </div>
            <div class="limitation-card">
                <h4>Column Limits</h4>
                <div class="limit">~400 columns</div>
                <p>Practical limit around 50-100 for usability.</p>
                <div class="workaround"><strong>Impact:</strong> lsapp5000 has 130+ course fields; would need trimming or splitting.</div>
            </div>
        </div>

        <h3>2.1 Delegation in Power Apps</h3>

        <div class="warning-box">
            <strong>Understanding Delegation:</strong> Power Apps has two modes:
            <ul>
                <li><strong>Delegable:</strong> Query runs on SharePoint; returns all matching items</li>
                <li><strong>Non-delegable:</strong> Power Apps downloads data locally, then filters; limited to 500-2,000 rows</li>
            </ul>
            <p>Many common operations are <strong>NOT delegable</strong> with SharePoint:</p>
            <ul>
                <li><code>Search()</code> function - not delegable</li>
                <li><code>StartsWith()</code> on non-indexed columns - not delegable</li>
                <li>Complex <code>Filter()</code> with OR conditions - partially delegable</li>
                <li><code>Sort()</code> on calculated columns - not delegable</li>
                <li><code>LookUp()</code> with complex conditions - not delegable</li>
            </ul>
        </div>

        <h3>2.2 Comparison: SQLite vs SharePoint Queries</h3>

        <div class="comparison-grid">
            <div class="comparison-card sqlite">
                <h4>SQLite (lsapp5000)</h4>
                <pre><code><span class="comment">-- Full-text search with ranking</span>
<span class="keyword">SELECT</span> c.*, bm25(courses_fts) <span class="keyword">AS</span> rank
<span class="keyword">FROM</span> courses_fts
<span class="keyword">JOIN</span> courses c <span class="keyword">ON</span> courses_fts.CourseID = c.CourseID
<span class="keyword">WHERE</span> courses_fts <span class="keyword">MATCH</span> <span class="string">'leadership training'</span>
<span class="keyword">ORDER BY</span> rank
<span class="keyword">LIMIT</span> <span class="value">50</span>;</code></pre>
                <p><strong>Result:</strong> Returns top 50 most relevant courses, ranked by BM25 algorithm. Works on any data volume.</p>
            </div>
            <div class="comparison-card sharepoint">
                <h4>SharePoint + Power Apps</h4>
                <pre><code><span class="comment">// Power Apps formula (NOT delegable)</span>
Search(
    Courses,
    SearchInput.Text,
    "CourseName", "CourseDescription"
)

<span class="comment">// Alternative: delegable but limited</span>
Filter(
    Courses,
    StartsWith(CourseName, SearchInput.Text)
)</code></pre>
                <p><strong>Result:</strong> <code>Search()</code> downloads ALL courses then filters locally. <code>StartsWith()</code> works but only matches beginning of text.</p>
            </div>
        </div>
    </section>

    <section id="power-apps" class="section">
        <h2>3. Power Apps Architecture</h2>

        <h3>3.1 App Structure</h3>
        <p>A Power Apps solution for LSApp would require multiple apps or a complex multi-screen app:</p>

        <table>
            <thead>
                <tr>
                    <th>App/Screen</th>
                    <th>Purpose</th>
                    <th>Complexity</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Course Catalog</td>
                    <td>Browse, search, filter courses</td>
                    <td>High (delegation issues)</td>
                </tr>
                <tr>
                    <td>Course Detail</td>
                    <td>View course info, classes, instructors</td>
                    <td>Medium</td>
                </tr>
                <tr>
                    <td>Course Edit</td>
                    <td>Admin form for course modifications</td>
                    <td>Medium-High (many fields)</td>
                </tr>
                <tr>
                    <td>Class List</td>
                    <td>Upcoming classes, calendar view</td>
                    <td>Medium</td>
                </tr>
                <tr>
                    <td>Class Detail</td>
                    <td>View class info, enrollment, notes</td>
                    <td>Medium</td>
                </tr>
                <tr>
                    <td>Change Requests</td>
                    <td>List, create, manage change requests</td>
                    <td>High (workflow integration)</td>
                </tr>
                <tr>
                    <td>Dashboard</td>
                    <td>Statistics, metrics</td>
                    <td>Medium (or use Power BI)</td>
                </tr>
                <tr>
                    <td>Admin Panel</td>
                    <td>People, venues, partners management</td>
                    <td>Medium</td>
                </tr>
            </tbody>
        </table>

        <h3>3.2 Power Apps Limitations for LSApp</h3>

        <ul>
            <li><strong>No server-side code:</strong> All logic must be in formulas or Power Automate</li>
            <li><strong>Limited Markdown support:</strong> Can't render course descriptions in Markdown like lsapp5000</li>
            <li><strong>Formula complexity limits:</strong> Very long formulas become unmanageable</li>
            <li><strong>Performance:</strong> Complex screens with many controls load slowly</li>
            <li><strong>Version control:</strong> No Git integration; harder to track changes</li>
            <li><strong>Custom styling:</strong> Limited compared to CSS; Bootstrap-like themes not available</li>
        </ul>

        <h3>3.3 Example: Course Search Screen</h3>

        <pre><code><span class="comment">// Gallery Items property - attempting search with delegation workaround</span>
<span class="keyword">If</span>(
    IsBlank(SearchInput.Text),
    <span class="comment">// No search term - show all active courses (delegable)</span>
    Filter(Courses, Status = <span class="string">"Active"</span>),

    <span class="comment">// With search term - NOT fully delegable!</span>
    <span class="keyword">If</span>(
        Len(SearchInput.Text) >= <span class="value">3</span>,
        <span class="comment">// Search function downloads all data locally</span>
        Search(
            Filter(Courses, Status = <span class="string">"Active"</span>),
            SearchInput.Text,
            <span class="string">"CourseName"</span>,
            <span class="string">"CourseDescription"</span>,
            <span class="string">"Keywords"</span>
        ),
        <span class="comment">// For short terms, use delegable StartsWith</span>
        Filter(
            Courses,
            Status = <span class="string">"Active"</span> &&
            StartsWith(CourseName, SearchInput.Text)
        )
    )
)

<span class="comment">// WARNING: Search() will only work correctly if
// total Active courses &lt; 2000 (delegation limit)</span></code></pre>
    </section>

    <section id="power-automate" class="section">
        <h2>4. Power Automate Workflows</h2>

        <h3>4.1 Required Flows</h3>

        <table>
            <thead>
                <tr>
                    <th>Flow</th>
                    <th>Trigger</th>
                    <th>Actions</th>
                    <th>Complexity</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Change Request Notification</td>
                    <td>When item created in CourseChanges</td>
                    <td>Send email to assigned person; post to Teams</td>
                    <td>Easy</td>
                </tr>
                <tr>
                    <td>Change Request Approval</td>
                    <td>When status changes to "Pending Approval"</td>
                    <td>Start approval; update status; notify requester</td>
                    <td>Medium</td>
                </tr>
                <tr>
                    <td>Change Timeline Logger</td>
                    <td>When item modified in CourseChanges</td>
                    <td>Compare old/new values; create timeline entry</td>
                    <td>Complex</td>
                </tr>
                <tr>
                    <td>ELM Sync (Scheduled)</td>
                    <td>Recurrence (daily/weekly)</td>
                    <td>Fetch CSV; parse; compare; update courses</td>
                    <td>Very Complex</td>
                </tr>
                <tr>
                    <td>Upcoming Class Reminder</td>
                    <td>Recurrence (daily)</td>
                    <td>Query classes starting in 7 days; send notifications</td>
                    <td>Medium</td>
                </tr>
            </tbody>
        </table>

        <h3>4.2 ELM Sync Challenge</h3>

        <div class="danger-box">
            <strong>Major Challenge:</strong> The ELM sync process in lsapp5000 is sophisticated:
            <ol>
                <li>Parse external CSV files</li>
                <li>Merge keywords with course data</li>
                <li>Compare each course field with database</li>
                <li>Log specific field changes with old/new values</li>
                <li>Handle persistence flags for removed courses</li>
                <li>Track sync run statistics</li>
            </ol>
            <p>Replicating this in Power Automate would require:</p>
            <ul>
                <li><strong>Premium HTTP connector</strong> - to fetch external CSV</li>
                <li><strong>Custom parsing logic</strong> - CSV parsing is limited in Power Automate</li>
                <li><strong>Hundreds of flow runs</strong> - one per course comparison</li>
                <li><strong>Complex condition logic</strong> - field-by-field comparison</li>
                <li><strong>Potential Azure Function</strong> - for heavy processing</li>
            </ul>
            <p>Estimated complexity: <strong>Very High</strong>. May require Azure Logic Apps or Azure Functions for practical implementation.</p>
        </div>

        <h3>4.3 Sample Flow: Change Timeline Logger</h3>

        <div class="flow-diagram">
            <div class="flow-step">
                <div class="step-box">Trigger: When item modified</div>
                <span class="arrow">→</span>
                <div class="step-box">Get previous version</div>
            </div>
            <div class="flow-step">
                <span style="width: 200px;"></span>
                <span class="arrow">↓</span>
            </div>
            <div class="flow-step">
                <div class="step-box">Compare: Description changed?</div>
                <span class="arrow">→</span>
                <div class="step-box">Create timeline entry</div>
            </div>
            <div class="flow-step">
                <span style="width: 200px;"></span>
                <span class="arrow">↓</span>
            </div>
            <div class="flow-step">
                <div class="step-box">Compare: Status changed?</div>
                <span class="arrow">→</span>
                <div class="step-box">Create timeline entry</div>
            </div>
            <div class="flow-step">
                <span style="width: 200px;"></span>
                <span class="arrow">↓</span>
            </div>
            <div class="flow-step">
                <div class="step-box">Compare: AssignedTo changed?</div>
                <span class="arrow">→</span>
                <div class="step-box">Create timeline entry + notify</div>
            </div>
            <p style="margin-top: 15px;"><strong>Issue:</strong> SharePoint doesn't store previous values on modification. You need to maintain a "shadow" list or use version history API (complex).</p>
        </div>
    </section>

    <section id="search" class="section">
        <h2>5. Search Comparison: FTS5 vs SharePoint</h2>

        <h3>5.1 Feature Comparison</h3>

        <table>
            <thead>
                <tr>
                    <th>Capability</th>
                    <th>SQLite FTS5</th>
                    <th>SharePoint Search</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Full-text search</td>
                    <td>Yes - dedicated FTS5 engine</td>
                    <td>Yes - Microsoft Search</td>
                </tr>
                <tr>
                    <td>Relevance ranking</td>
                    <td>BM25 with tunable weights</td>
                    <td>Proprietary algorithm</td>
                </tr>
                <tr>
                    <td>Phrase matching</td>
                    <td>Yes - "exact phrase"</td>
                    <td>Yes</td>
                </tr>
                <tr>
                    <td>Prefix matching</td>
                    <td>Yes - term*</td>
                    <td>Yes</td>
                </tr>
                <tr>
                    <td>Boolean operators</td>
                    <td>AND, OR, NOT</td>
                    <td>AND, OR, NOT</td>
                </tr>
                <tr>
                    <td>Field-specific search</td>
                    <td>Yes - CourseName:leadership</td>
                    <td>Limited - managed properties</td>
                </tr>
                <tr>
                    <td>Customizable ranking</td>
                    <td>Yes - weights per field</td>
                    <td>Limited - query rules</td>
                </tr>
                <tr>
                    <td>Instant results</td>
                    <td>Yes - indexed, immediate</td>
                    <td>Crawl delay (minutes to hours)</td>
                </tr>
                <tr>
                    <td>Works in Power Apps</td>
                    <td>N/A (different platform)</td>
                    <td>No - Search() is different</td>
                </tr>
                <tr>
                    <td>Structured data queries</td>
                    <td>Excellent - SQL</td>
                    <td>Limited - KQL</td>
                </tr>
            </tbody>
        </table>

        <div class="warning-box">
            <strong>Key Issue:</strong> SharePoint Search and Power Apps <code>Search()</code> function are different systems:
            <ul>
                <li><strong>SharePoint Search:</strong> Enterprise search across all content; requires crawling; uses KQL</li>
                <li><strong>Power Apps Search():</strong> Client-side text search; downloads all data; not delegable</li>
            </ul>
            <p>To use SharePoint Search in Power Apps, you'd need a custom connector or Flow - adding complexity.</p>
        </div>

        <h3>5.2 Search Quality Example</h3>

        <div class="comparison-grid">
            <div class="comparison-card sqlite">
                <h4>lsapp5000: Search "leadership communication"</h4>
                <p>FTS5 finds documents containing both terms, ranks by:</p>
                <ul>
                    <li>Term frequency in document</li>
                    <li>Term rarity across corpus</li>
                    <li>Document length normalization</li>
                </ul>
                <p><strong>Result:</strong> "Leadership Communication Skills" ranks #1; "Public Speaking for Leaders" ranks lower.</p>
            </div>
            <div class="comparison-card sharepoint">
                <h4>Power Apps: Search "leadership communication"</h4>
                <p>Search() function performs simple text matching:</p>
                <ul>
                    <li>Finds substring in specified fields</li>
                    <li>No relevance ranking</li>
                    <li>Returns in list order</li>
                </ul>
                <p><strong>Result:</strong> All matches returned in arbitrary order; user must scroll to find best match.</p>
            </div>
        </div>
    </section>

    <section id="data-migration" class="section">
        <h2>6. Data Migration Strategy</h2>

        <h3>6.1 Migration Approach</h3>

        <ol>
            <li><strong>Export from SQLite:</strong>
                <pre><code>sqlite3 course_management.db <span class="string">".mode csv"</span> <span class="string">".output courses.csv"</span> <span class="string">"SELECT * FROM courses;"</span></code></pre>
            </li>
            <li><strong>Transform Data:</strong> Map SQLite columns to SharePoint column types; handle data type conversions</li>
            <li><strong>Import to SharePoint:</strong>
                <ul>
                    <li>Use Power Automate for small datasets</li>
                    <li>Use SharePoint Migration Tool for bulk</li>
                    <li>Consider PnP PowerShell for complex scenarios</li>
                </ul>
            </li>
            <li><strong>Establish Relationships:</strong> Re-create lookup relationships; verify referential integrity</li>
            <li><strong>Validate:</strong> Compare record counts; spot-check data accuracy</li>
        </ol>

        <h3>6.2 Data Type Mapping</h3>

        <table>
            <thead>
                <tr>
                    <th>SQLite Type</th>
                    <th>SharePoint Type</th>
                    <th>Notes</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>TEXT (short)</td>
                    <td>Single line of text</td>
                    <td>255 char limit</td>
                </tr>
                <tr>
                    <td>TEXT (long)</td>
                    <td>Multiple lines of text</td>
                    <td>Rich text if HTML needed</td>
                </tr>
                <tr>
                    <td>INTEGER</td>
                    <td>Number</td>
                    <td>Decimal places configurable</td>
                </tr>
                <tr>
                    <td>REAL</td>
                    <td>Number</td>
                    <td>Set appropriate decimals</td>
                </tr>
                <tr>
                    <td>TEXT (date)</td>
                    <td>Date and Time</td>
                    <td>May need format conversion</td>
                </tr>
                <tr>
                    <td>INTEGER (boolean)</td>
                    <td>Yes/No</td>
                    <td>0/1 → No/Yes</td>
                </tr>
                <tr>
                    <td>Foreign Key (ID)</td>
                    <td>Lookup column</td>
                    <td>Requires list to exist first</td>
                </tr>
            </tbody>
        </table>

        <h3>6.3 Migration Risks</h3>

        <ul>
            <li><strong>Data Loss:</strong> Rich formatting may not transfer; validate thoroughly</li>
            <li><strong>Relationship Integrity:</strong> Lookup columns require exact title matches</li>
            <li><strong>Historical Data:</strong> Change timeline entries need careful mapping</li>
            <li><strong>File Attachments:</strong> Need separate migration to document library</li>
        </ul>
    </section>

    <section id="security" class="section">
        <h2>7. Security & Permissions Model</h2>

        <h3>7.1 SharePoint Permissions</h3>

        <table>
            <thead>
                <tr>
                    <th>lsapp5000 Role</th>
                    <th>SharePoint Equivalent</th>
                    <th>Configuration</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Authenticated User (basic)</td>
                    <td>Site Members (Read/Contribute)</td>
                    <td>Can view courses, submit change requests</td>
                </tr>
                <tr>
                    <td>Super User (admin)</td>
                    <td>Site Owners or Custom Permission Level</td>
                    <td>Can edit courses, manage all data</td>
                </tr>
            </tbody>
        </table>

        <h3>7.2 Considerations</h3>

        <ul>
            <li><strong>IDIR Integration:</strong> Azure AD already federated with IDIR; users authenticate seamlessly</li>
            <li><strong>List-Level Permissions:</strong> Can restrict edit access per list</li>
            <li><strong>Item-Level Permissions:</strong> Possible but adds overhead; avoid if possible</li>
            <li><strong>Power Apps Security:</strong> App-level sharing; respects SharePoint permissions for data</li>
        </ul>

        <div class="success-box">
            <strong>Advantage:</strong> MS365 authentication is already in place. No additional auth setup required. IDIR users can access immediately via existing federation.
        </div>
    </section>

    <section id="elm-sync" class="section">
        <h2>8. ELM Sync Implementation Challenges</h2>

        <h3>8.1 Current lsapp5000 Sync Process</h3>

        <pre><code><span class="comment">// Simplified sync logic from elm-course-sync.php</span>
<span class="keyword">foreach</span> ($csvCourses <span class="keyword">as</span> $course) {
    $existing = $db->query(<span class="string">"SELECT * FROM courses WHERE ELMCourseID = ?"</span>, [$course[<span class="string">'id'</span>]]);

    <span class="keyword">if</span> (!$existing) {
        <span class="comment">// Insert new course</span>
        insertCourse($course);
        logChange(<span class="string">'new'</span>, $course);
    } <span class="keyword">else</span> {
        <span class="comment">// Compare each field</span>
        $changes = compareFields($existing, $course);
        <span class="keyword">if</span> ($changes) {
            updateCourse($course);
            <span class="keyword">foreach</span> ($changes <span class="keyword">as</span> $field => $diff) {
                logChange(<span class="string">'updated'</span>, $course, $field, $diff[<span class="string">'old'</span>], $diff[<span class="string">'new'</span>]);
            }
        }
    }
}

<span class="comment">// Handle courses removed from feed</span>
<span class="keyword">foreach</span> ($existingNotInFeed <span class="keyword">as</span> $course) {
    <span class="keyword">if</span> ($course[<span class="string">'HubIncludePersist'</span>] === <span class="string">'Yes'</span>) {
        markPersistedInactive($course);
    } <span class="keyword">else</span> {
        removeFromHub($course);
    }
}</code></pre>

        <h3>8.2 Power Automate Challenges</h3>

        <div class="danger-box">
            <strong>Significant Barriers:</strong>
            <ol>
                <li><strong>CSV Parsing:</strong> Power Automate has limited CSV parsing. Would need:
                    <ul>
                        <li>Premium HTTP connector to fetch file</li>
                        <li>Custom parsing via expressions or Azure Function</li>
                    </ul>
                </li>
                <li><strong>Looping Limits:</strong> "Apply to each" over 300+ courses hits performance issues</li>
                <li><strong>Field Comparison:</strong> Comparing 50+ fields per course is impractical in flow expressions</li>
                <li><strong>Flow Run Limits:</strong> Each sync could consume thousands of API calls</li>
                <li><strong>Error Handling:</strong> Complex error handling difficult to implement</li>
            </ol>
        </div>

        <h3>8.3 Realistic MS365 Sync Options</h3>

        <table>
            <thead>
                <tr>
                    <th>Option</th>
                    <th>Description</th>
                    <th>Feasibility</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Power Automate (Basic)</td>
                    <td>Simple flow with limited comparison</td>
                    <td>Partial - loses detailed tracking</td>
                </tr>
                <tr>
                    <td>Azure Logic Apps</td>
                    <td>More powerful workflows with better parsing</td>
                    <td>Possible - additional cost</td>
                </tr>
                <tr>
                    <td>Azure Function</td>
                    <td>Custom code (C#/Python) for heavy processing</td>
                    <td>Best - but requires development</td>
                </tr>
                <tr>
                    <td>Keep lsapp5000 for Sync</td>
                    <td>Hybrid: lsapp5000 syncs, pushes to SharePoint</td>
                    <td>Pragmatic workaround</td>
                </tr>
                <tr>
                    <td>Manual Sync</td>
                    <td>Admin uploads CSV, flow processes</td>
                    <td>Simple but not automated</td>
                </tr>
            </tbody>
        </table>
    </section>

    <section id="power-bi" class="section">
        <h2>9. Power BI Integration</h2>

        <h3>9.1 Dashboard Capabilities</h3>

        <div class="success-box">
            <strong>Good Fit:</strong> Power BI excels at creating dashboards and could enhance either platform:
            <ul>
                <li>Connect directly to SharePoint Lists</li>
                <li>Or connect to lsapp5000's SQLite database via gateway</li>
                <li>Rich visualizations (charts, graphs, maps)</li>
                <li>Scheduled refresh</li>
                <li>Embed in SharePoint or Teams</li>
            </ul>
        </div>

        <h3>9.2 Example Metrics</h3>

        <ul>
            <li>Course count by status, topic, delivery method</li>
            <li>Classes scheduled by month, venue</li>
            <li>Enrollment trends over time</li>
            <li>Change request volume and resolution time</li>
            <li>Partner course distribution</li>
        </ul>

        <h3>9.3 Licensing Consideration</h3>

        <p>Power BI Pro ($10/user/month) required for:</p>
        <ul>
            <li>Sharing dashboards with others</li>
            <li>Publishing to workspace</li>
            <li>Scheduled refresh</li>
        </ul>
        <p>Free tier only allows personal use.</p>
    </section>

    <section id="platform-churn" class="section">
        <h2>10. Platform Churn History</h2>

        <div class="warning-box">
            <strong>Historical Pattern:</strong> Microsoft regularly deprecates, renames, and replaces tools. This creates ongoing maintenance burden.
        </div>

        <h3>10.1 Notable Changes (2015-2025)</h3>

        <table>
            <thead>
                <tr>
                    <th>Year</th>
                    <th>Deprecated/Changed</th>
                    <th>Replaced By</th>
                    <th>Migration Impact</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>2017</td>
                    <td>InfoPath</td>
                    <td>Power Apps</td>
                    <td>Complete rebuild required</td>
                </tr>
                <tr>
                    <td>2019</td>
                    <td>Microsoft Flow</td>
                    <td>Power Automate</td>
                    <td>Rebranding; UI changes</td>
                </tr>
                <tr>
                    <td>2020</td>
                    <td>Classic SharePoint</td>
                    <td>Modern SharePoint</td>
                    <td>Page rebuilds; feature gaps</td>
                </tr>
                <tr>
                    <td>2021</td>
                    <td>SharePoint Workflows</td>
                    <td>Power Automate</td>
                    <td>Complete rebuild required</td>
                </tr>
                <tr>
                    <td>2023</td>
                    <td>Power Apps portal</td>
                    <td>Power Pages</td>
                    <td>Rebranding; licensing changes</td>
                </tr>
                <tr>
                    <td>2024</td>
                    <td>Dataverse for Teams</td>
                    <td>Consolidated Dataverse</td>
                    <td>Licensing impact</td>
                </tr>
                <tr>
                    <td>Ongoing</td>
                    <td>Connector deprecations</td>
                    <td>New versions</td>
                    <td>Flow updates required</td>
                </tr>
            </tbody>
        </table>

        <h3>10.2 Projected Next 8 Years</h3>

        <p>Based on historical patterns, expect:</p>
        <ul>
            <li><strong>2-3 major UI overhauls</strong> requiring screen redesigns</li>
            <li><strong>1-2 product renames/mergers</strong> affecting documentation and training</li>
            <li><strong>Multiple connector updates</strong> requiring flow modifications</li>
            <li><strong>Licensing model changes</strong> potentially affecting costs</li>
            <li><strong>Feature deprecations</strong> requiring workarounds</li>
        </ul>

        <div class="info-box">
            <strong>Contrast with PHP/SQLite:</strong> PHP 5.6 code from 2014 still runs on PHP 8.3 with minimal changes. SQLite databases from the 1990s are still readable. The stability profile is dramatically different.
        </div>
    </section>

    <section id="hybrid" class="section">
        <h2>11. Hybrid Architecture Option</h2>

        <p>Rather than full migration, a hybrid approach leverages MS365 strengths while keeping lsapp5000's core:</p>

        <h3>11.1 Hybrid Architecture</h3>

        <div class="flow-diagram" style="text-align: center;">
            <pre style="display: inline-block; text-align: left;">
┌─────────────────────────────────────────────────────────────────┐
│                         Users                                    │
└─────────────────────────────────────────────────────────────────┘
                              │
        ┌─────────────────────┼─────────────────────┐
        │                     │                     │
        ▼                     ▼                     ▼
┌───────────────┐    ┌───────────────┐    ┌───────────────┐
│   lsapp5000   │    │   Power BI    │    │    Teams      │
│  (PHP/SQLite) │    │  Dashboards   │    │ Notifications │
│               │◄───┤               │    │               │
│ • Course CRUD │    │ • Analytics   │    │ • Webhooks    │
│ • Classes     │    │ • Reports     │    │ • Alerts      │
│ • Changes     │    │ • Trends      │    │ • Bot         │
│ • ELM Sync    │    │               │    │               │
│ • Search      │    │               │    │               │
└───────────────┘    └───────────────┘    └───────────────┘
        │                     ▲                     ▲
        │                     │                     │
        └─────────────────────┴─────────────────────┘
                    SQLite Database
                    (Single source of truth)
            </pre>
        </div>

        <h3>11.2 Hybrid Components</h3>

        <table>
            <thead>
                <tr>
                    <th>Component</th>
                    <th>Platform</th>
                    <th>Rationale</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Core Application</td>
                    <td>lsapp5000</td>
                    <td>Custom workflows, search, data management</td>
                </tr>
                <tr>
                    <td>Analytics Dashboards</td>
                    <td>Power BI</td>
                    <td>Rich visualizations; executive reporting</td>
                </tr>
                <tr>
                    <td>Notifications</td>
                    <td>Teams Webhooks</td>
                    <td>Instant alerts to team channel</td>
                </tr>
                <tr>
                    <td>Document Storage</td>
                    <td>SharePoint</td>
                    <td>Course materials, attachments</td>
                </tr>
                <tr>
                    <td>Feedback Forms</td>
                    <td>Microsoft Forms</td>
                    <td>Easy form creation; data flows to lsapp5000</td>
                </tr>
            </tbody>
        </table>

        <h3>11.3 Implementation Example: Teams Notifications</h3>

        <pre><code><span class="comment">// In lsapp5000 PHP code - send to Teams on change request</span>
<span class="keyword">function</span> <span class="property">notifyTeams</span>($changeRequest) {
    $webhookUrl = getenv(<span class="string">'TEAMS_WEBHOOK_URL'</span>);

    $payload = [
        <span class="string">'@type'</span> => <span class="string">'MessageCard'</span>,
        <span class="string">'summary'</span> => <span class="string">'New Change Request'</span>,
        <span class="string">'themeColor'</span> => <span class="string">'0078D4'</span>,
        <span class="string">'title'</span> => <span class="string">'Course Change Request #'</span> . $changeRequest[<span class="string">'changeid'</span>],
        <span class="string">'sections'</span> => [[
            <span class="string">'facts'</span> => [
                [<span class="string">'name'</span> => <span class="string">'Course'</span>, <span class="string">'value'</span> => $changeRequest[<span class="string">'coursename'</span>]],
                [<span class="string">'name'</span> => <span class="string">'Category'</span>, <span class="string">'value'</span> => $changeRequest[<span class="string">'category'</span>]],
                [<span class="string">'name'</span> => <span class="string">'Requested By'</span>, <span class="string">'value'</span> => $changeRequest[<span class="string">'created_by'</span>]],
                [<span class="string">'name'</span> => <span class="string">'Urgent'</span>, <span class="string">'value'</span> => $changeRequest[<span class="string">'urgent'</span>] ? <span class="string">'Yes'</span> : <span class="string">'No'</span>]
            ]
        ]],
        <span class="string">'potentialAction'</span> => [[
            <span class="string">'@type'</span> => <span class="string">'OpenUri'</span>,
            <span class="string">'name'</span> => <span class="string">'View Request'</span>,
            <span class="string">'targets'</span> => [[<span class="string">'uri'</span> => <span class="string">'https://lsapp.gov.bc.ca/course-changes/view.php?id='</span> . $changeRequest[<span class="string">'changeid'</span>]]]
        ]]
    ];

    $ch = curl_init($webhookUrl);
    curl_setopt($ch, CURLOPT_POST, <span class="value">true</span>);
    curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($payload));
    curl_setopt($ch, CURLOPT_HTTPHEADER, [<span class="string">'Content-Type: application/json'</span>]);
    curl_exec($ch);
    curl_close($ch);
}</code></pre>
    </section>

    <section id="licensing" class="section">
        <h2>12. Licensing Deep Dive</h2>

        <h3>12.1 What's Included in Government MS365</h3>

        <p>Standard G3/G5 licenses typically include:</p>
        <ul>
            <li>SharePoint Online (Lists, Libraries, Sites)</li>
            <li>Power Apps for Office 365 (limited - SharePoint customization only)</li>
            <li>Power Automate for Office 365 (standard connectors only)</li>
            <li>Power BI Free (personal use only)</li>
            <li>Microsoft Forms</li>
            <li>Teams</li>
        </ul>

        <h3>12.2 Additional Licensing Required</h3>

        <table>
            <thead>
                <tr>
                    <th>Capability Needed</th>
                    <th>License Required</th>
                    <th>Est. Cost/User/Month</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Standalone Power Apps (not just SharePoint forms)</td>
                    <td>Power Apps per-user or per-app</td>
                    <td>$5 - $20</td>
                </tr>
                <tr>
                    <td>Premium connectors (HTTP, SQL, etc.)</td>
                    <td>Power Automate Premium</td>
                    <td>$15</td>
                </tr>
                <tr>
                    <td>Share Power BI dashboards</td>
                    <td>Power BI Pro</td>
                    <td>$10</td>
                </tr>
                <tr>
                    <td>Dataverse storage (if using)</td>
                    <td>Capacity add-on</td>
                    <td>Variable</td>
                </tr>
                <tr>
                    <td>Azure Functions (for sync)</td>
                    <td>Azure consumption</td>
                    <td>Variable (likely minimal)</td>
                </tr>
            </tbody>
        </table>

        <h3>12.3 Per-App vs Per-User Licensing</h3>

        <div class="info-box">
            <strong>Power Apps Licensing Models:</strong>
            <ul>
                <li><strong>Per-app ($5/user/app/month):</strong> Users can access ONE specific app. Good if you have few apps, many users.</li>
                <li><strong>Per-user ($20/user/month):</strong> Users can access UNLIMITED apps. Good if you have many apps, fewer users.</li>
            </ul>
            <p>For LSApp (likely 1-2 apps, ~10-20 users): <strong>Per-app is probably cheaper</strong> = ~$50-100/month total.</p>
        </div>

        <h3>12.4 Hidden Costs</h3>

        <ul>
            <li><strong>Training:</strong> Staff need to learn Power Platform development</li>
            <li><strong>Consulting:</strong> May need external help for complex features (ELM sync)</li>
            <li><strong>Ongoing maintenance:</strong> Platform updates require attention</li>
            <li><strong>Opportunity cost:</strong> Time spent on platform issues vs. feature development</li>
        </ul>
    </section>

    <footer>
        <p>This technical addendum accompanies the Executive Report for LSApp MS365 Migration Analysis.</p>
        <p>Generated January 9, 2026 | For Technical Leadership Review</p>
    </footer>
</body>
</html>
